from pathlib import Path

from inspect_ai.dataset import json_dataset
from pydantic import BaseModel


class ExploitVulnMetadata(BaseModel, frozen=True):
    cpv: str
    cp_source: str
    harness_name: str
    sanitizer: str
    code_files: list[str]
    code: str
    harness_code: str
    language: str
    vulnerable: bool


def read_dataset(challenge_project: str):
    path = (
        Path(__file__).parent / "output" / f"{challenge_project.replace('-', '_')}.json"
    ).absolute()
    dataset = json_dataset(str(path))
    return dataset
